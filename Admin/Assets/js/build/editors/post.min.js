/*! For license information please see post.min.js.LICENSE.txt */
(()=>{"use strict";const t=window.wp.plugins,e=window.wp.i18n,n=window.wp.editPost,a=window.wp.components,r=window.wp.apiFetch,l=window.wp.element,i=window.wp.data,o=window.React,u=t=>{const e=(t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,n)=>n?n.toUpperCase():e.toLowerCase()))(t);return e.charAt(0).toUpperCase()+e.slice(1)},c=(...t)=>t.filter((t,e,n)=>Boolean(t)&&""!==t.trim()&&n.indexOf(t)===e).join(" ").trim(),s=t=>{for(const e in t)if(e.startsWith("aria-")||"role"===e||"title"===e)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const g=(0,o.forwardRef)(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:i,...u},g)=>(0,o.createElement)("svg",{ref:g,...d,width:e,height:e,stroke:t,strokeWidth:a?24*Number(n)/Number(e):n,className:c("lucide",r),...!l&&!s(u)&&{"aria-hidden":"true"},...u},[...i.map(([t,e])=>(0,o.createElement)(t,e)),...Array.isArray(l)?l:[l]])),f=(t,e)=>{const n=(0,o.forwardRef)(({className:n,...a},r)=>{return(0,o.createElement)(g,{ref:r,iconNode:e,className:c(`lucide-${l=u(t),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${t}`,n),...a});var l});return n.displayName=u(t),n},m=f("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),p=f("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function v(){var t,e,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var u=a&&a.prototype instanceof o?a:o,c=Object.create(u.prototype);return h(c,"_invoke",function(n,a,r){var l,o,u,c=0,s=r||[],d=!1,g={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return l=e,o=0,u=t,g.n=n,i}};function f(n,a){for(o=n,u=a,e=0;!d&&c&&!r&&e<s.length;e++){var r,l=s[e],f=g.p,m=l[2];n>3?(r=m===a)&&(u=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=t):l[0]<=f&&((r=n<2&&f<l[1])?(o=0,g.v=a,g.n=l[1]):f<m&&(r=n<3||l[0]>a||a>m)&&(l[4]=n,l[5]=a,g.n=m,o=0))}if(r||n>1)return i;throw d=!0,a}return function(r,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,m),o=s,u=m;(e=o<2?t:u)||!d;){l||(o?o<3?(o>1&&(g.n=-1),f(o,u)):g.n=u:g.v=u);try{if(c=2,l){if(o||(r="next"),e=l[r]){if(!(e=e.call(l,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,o<2&&(o=0)}else 1===o&&(e=l.return)&&e.call(l),o<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=t}else if((e=(d=g.n<0)?u:n.call(a,g))!==i)break}catch(e){l=t,o=1,u=e}finally{c=1}}return{value:e,done:d}}}(n,r,l),!0),c}var i={};function o(){}function u(){}function c(){}e=Object.getPrototypeOf;var s=[][a]?e(e([][a]())):(h(e={},a,function(){return this}),e),d=c.prototype=o.prototype=Object.create(s);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,h(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=c,h(d,"constructor",c),h(c,"constructor",u),u.displayName="GeneratorFunction",h(c,r,"GeneratorFunction"),h(d),h(d,r,"Generator"),h(d,a,function(){return this}),h(d,"toString",function(){return"[object Generator]"}),(v=function(){return{w:l,m:g}})()}function h(t,e,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}h=function(t,e,n,a){function l(e,n){h(t,e,function(t){return this._invoke(e,n,t)})}e?r?r(t,e,{value:n,enumerable:!a,configurable:!a,writable:!a}):t[e]=n:(l("next",0),l("throw",1),l("return",2))},h(t,e,n,a)}function y(t,e,n,a,r,l,i){try{var o=t[l](i),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(a,r)}function _(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var l=t.apply(e,n);function i(t){y(l,a,r,i,o,"next",t)}function o(t){y(l,a,r,i,o,"throw",t)}i(void 0)})}}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,r,l,i,o=[],u=!0,c=!1;try{if(l=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(a=l.call(n)).done)&&(o.push(a.value),o.length!==e);u=!0);}catch(t){c=!0,r=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}var k,E,R="lmat-post-sidebar",x=function(){try{if("undefined"!=typeof lmat_block_editor_plugin_settings)return lmat_block_editor_plugin_settings}catch(t){}return"undefined"!=typeof window&&window.lmat_block_editor_plugin_settings?window.lmat_block_editor_plugin_settings:{lang:null,translations_table:{}}},C=function(t){var n=t.lang,r=t.allLanguages,i=(0,l.useMemo)(function(){var t=[];return n&&t.push({label:n.name,value:n.slug,flag_url:n.flag_url}),Object.values(r).forEach(function(e){t.push({label:e.lang.name,value:e.lang.slug,flag_url:e.lang.flag_url})}),t},[n,r]);return React.createElement(a.PanelBody,{title:(0,e.__)("Language","linguator-multilingual-ai-translation"),initialOpen:!0},React.createElement(a.Flex,{align:"center"},React.createElement(a.FlexItem,null,null!=n&&n.flag_url?React.createElement("img",{src:n.flag_url,alt:(null==n?void 0:n.name)||"",className:"flag",style:{marginRight:8}}):null),React.createElement(a.FlexItem,{style:{flex:1}},React.createElement(a.SelectControl,{label:void 0,value:(null==n?void 0:n.slug)||"",onChange:function(t){if(t&&(!n||t!==n.slug)){var e=null==r?void 0:r[t];if(e&&e.links){var a=e.links.edit_link||e.links.add_link;a&&(window.location.href=a)}}},help:void 0,options:i.map(function(t){return{label:t.label,value:t.value}})}))))},S=function(t){var n=t.row,o=n.lang,u=n.translated_post,c=n.links,s=(null==u?void 0:u.title)||"",d=w((0,l.useState)(s),2),g=d[0],f=d[1],h=w((0,l.useState)(!1),2),y=h[0],b=h[1],k=w((0,l.useState)(""),2),E=k[0],R=k[1],x=w((0,l.useState)([]),2),C=x[0],S=x[1],O=w((0,l.useState)(!1),2),P=O[0],T=O[1],j=w((0,l.useState)([]),2),I=j[0],L=j[1],A=w((0,l.useState)(null),2),F=A[0],N=A[1],M=w((0,l.useState)(!1),2),B=M[0],D=M[1],G=!s,W=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=(0,l.useRef)(null),a=(0,l.useRef)(t);a.current=t;var r=(0,l.useCallback)(function(){for(var t=arguments.length,r=new Array(t),l=0;l<t;l++)r[l]=arguments[l];n.current&&clearTimeout(n.current),n.current=setTimeout(function(){a.current.apply(a,r)},e)},[e]);return[r,(0,l.useCallback)(function(){n.current&&(clearTimeout(n.current),n.current=null)},[])]}(function(){var t=_(v().m(function t(n){var a;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:if(a=(n||"").trim()){t.n=1;break}return t.a(2);case 1:return t.p=1,b(!0),R(""),t.n=2,r({path:"/lmat/v1/translation-title",method:"POST",data:{postId:(null==u?void 0:u.id)||null,lang:null==o?void 0:o.slug,title:a}});case 2:b(!1),t.n=4;break;case 3:t.p=3,t.v,b(!1),R((0,e.__)("Failed to save title. Please try again.","linguator-multilingual-ai-translation"));case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),2e3),$=(w(W,1)[0],!(null==c||!c.edit_link)),z=!(null==c||!c.add_link),U=(0,l.useCallback)(_(v().m(function t(){var e;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(P||C.length>0)){t.n=1;break}return t.a(2);case 1:return t.p=1,T(!0),t.n=2,r({path:"/lmat/v1/languages/utils/get_all_pages_data"});case 2:e=t.v,S(Array.isArray(e)?e:[]),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.p=4,T(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])})),[P,C.length]),Z=(0,l.useCallback)(function(t){var e=(t||"").trim().toLowerCase();return e?C.filter(function(t){var n,a=(null==t||null===(n=t.language)||void 0===n?void 0:n.slug)===(null==o?void 0:o.slug),r=!(null!=t&&t.is_linked),l=((null==t?void 0:t.title)||"").toLowerCase().includes(e)||((null==t?void 0:t.slug)||"").toLowerCase().includes(e);return a&&r&&l}).slice(0,10):[]},[C,null==o?void 0:o.slug]),q=function(){var t=_(v().m(function t(n){var a,l,u;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.preventDefault(),F){t.n=1;break}return t.a(2);case 1:return t.p=1,D(!0),R(""),u=null===(a=(0,i.select)("core/editor"))||void 0===a||null===(l=a.getCurrentPostId)||void 0===l?void 0:l.call(a),t.n=2,r({path:"/lmat/v1/languages/link-translation",method:"POST",data:{source_id:u,target_id:F.ID,target_lang:null==o?void 0:o.slug}});case 2:window.location.reload(),t.n=4;break;case 3:t.p=3,t.v,R((0,e.__)("Failed to link page. Please try again.","linguator-multilingual-ai-translation"));case 4:return t.p=4,D(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(e){return t.apply(this,arguments)}}(),H=function(){var t=_(v().m(function t(n){var a,l,u,s,d,f,m;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.preventDefault(),a=(g||"").trim()){t.n=1;break}return null!=c&&c.add_link&&(window.location.href=c.add_link),t.a(2);case 1:return t.p=1,D(!0),R(""),f=null===(l=(0,i.select)("core/editor"))||void 0===l||null===(u=l.getCurrentPostId)||void 0===u?void 0:u.call(l),m=null===(s=(0,i.select)("core/editor"))||void 0===s||null===(d=s.getCurrentPostType)||void 0===d?void 0:d.call(s),t.n=2,r({path:"/lmat/v1/languages/create-translation",method:"POST",data:{source_id:f,target_lang:null==o?void 0:o.slug,title:a,post_type:m||"page"}});case 2:window.location.reload(),t.n=4;break;case 3:t.p=3,t.v,R((0,e.__)("Failed to create page. Please try again.","linguator-multilingual-ai-translation"));case 4:return t.p=4,D(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(e){return t.apply(this,arguments)}}();return React.createElement("div",{style:{marginBottom:12}},React.createElement(a.Flex,{align:"center",style:{marginBottom:8,alignItems:"start"}},React.createElement(a.FlexItem,{style:{paddingTop:"8px"}},null!=o&&o.flag_url?React.createElement("img",{src:o.flag_url,alt:(null==o?void 0:o.name)||"",style:{width:18,height:12}}):null),React.createElement(a.FlexItem,{style:{flex:1,padding:"0px"}},React.createElement(a.TextControl,{value:g,onChange:function(t){f(t),N(null),G&&(t&&t.trim().length>1?0===C.length?U().then(function(){L(Z(t))}):L(Z(t)):L([]))},placeholder:(0,e.__)("title","linguator-multilingual-ai-translation"),readOnly:!G,disabled:!G,help:G?y?(0,e.__)("Saving…","linguator-multilingual-ai-translation"):(0,e.__)("Type a title to create/update this translation (auto-saves).","linguator-multilingual-ai-translation"):(0,e.__)("Existing title. Use the Edit button to modify content.","linguator-multilingual-ai-translation")})),React.createElement(a.FlexItem,{style:{paddingTop:"8px"}},$?React.createElement("a",{href:c.edit_link,"aria-label":(0,e.__)("Edit translation","linguator-multilingual-ai-translation"),style:{marginLeft:8,height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(m,null)):null,!$&&(F?React.createElement("button",{onClick:q,"aria-label":(0,e.__)("Link existing page","linguator-multilingual-ai-translation"),style:{marginLeft:8,background:"transparent",border:0,padding:0,cursor:"pointer"}},React.createElement(p,null)):z?(g||"").trim().length>0?React.createElement("button",{onClick:H,"aria-label":(0,e.__)("Create translation from typed title","linguator-multilingual-ai-translation"),style:{marginLeft:8,background:"transparent",border:0,padding:0,cursor:"pointer"}},React.createElement(p,null)):React.createElement("a",{href:c.add_link,"aria-label":(0,e.__)("Add translation","linguator-multilingual-ai-translation"),style:{marginLeft:8,height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement(p,null)):null),y||B?React.createElement(a.Spinner,{style:{marginLeft:8}}):null)),G&&I.length>0?React.createElement("div",{style:{marginTop:4}},I.map(function(t){return React.createElement("div",{key:t.ID,style:{padding:"4px 6px",cursor:"pointer",background:(null==F?void 0:F.ID)===t.ID?"#eef":"transparent"},onClick:function(){return N(t)},onMouseEnter:function(){return N(t)}},t.title," (",t.slug,")")})):null,E?React.createElement(a.Notice,{status:"error",isDismissible:!1},E):null)},O=function(t){var n=t.translations,r=Object.values(n);return React.createElement(a.PanelBody,{title:(0,e.__)("Translations","linguator-multilingual-ai-translation"),initialOpen:!0},r.map(function(t){return React.createElement(S,{key:t.lang.slug,row:t})}))},P=null!=(E=(null==(k=x())?void 0:k.lang)||null)&&E.flag_url?React.createElement("img",{src:E.flag_url,alt:(null==E?void 0:E.name)||"",style:{width:16,height:11}}):React.createElement("svg",{width:"16",height:"11",viewBox:"0 0 16 11"},React.createElement("rect",{width:"16",height:"11",fill:"#ddd"}));(0,t.registerPlugin)(R,{render:function(){var t=x(),a=(null==t?void 0:t.lang)||null,r=(null==t?void 0:t.translations_table)||{};return React.createElement(React.Fragment,null,React.createElement(n.PluginSidebarMoreMenuItem,{target:R},(0,e.__)("Linguator","linguator-multilingual-ai-translation")),React.createElement(n.PluginSidebar,{name:R,title:(0,e.__)("Linguator","linguator-multilingual-ai-translation")},React.createElement(C,{lang:a,allLanguages:r}),React.createElement(O,{translations:r})))},icon:P})})();