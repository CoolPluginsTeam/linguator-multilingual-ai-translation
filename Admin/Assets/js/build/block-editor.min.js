(()=>{"use strict";var t=jQuery(".post_lang_choice"),e=function(){t.attr("data-old-value",t.children(":selected").first().val())};function a(){var t=document.querySelector("[name=post_lang_choice]");return null===t?lmatDefaultLanguage:t.value}function n(t){return void 0===t.data||null===t.data?t.path+=(t.path.indexOf("?")>=0?"&lang=":"?lang=")+a():t.data.lang=a(),t}wp.apiFetch.use(function(t,e){return void 0!==t.url||"undefined"==typeof lmatFilteredRoutes?e(t):e(function(t,e,a){var n=t.path.split("?")[0].replace(/^\/+|\/+$/g,"");return Object.values(e).find(function(t){return n===t})?a(t):t}(t,lmatFilteredRoutes,n))}),jQuery(function(a){e(),a(".post_lang_choice").on("change",function(n){var o,i,l,r,u=wp.data,c=u.select,s=u.dispatch,d=u.subscribe,g=!(null!==(o=(l=c("core/editor")).getEditedPostAttribute("title"))&&void 0!==o&&o.trim()||l.getEditedPostContent()||null!==(i=l.getEditedPostAttribute("excerpt"))&&void 0!==i&&i.trim()),p=wp.url.addQueryArgs,h=function(){var e=wp.i18n.__,a=jQuery("<div/>",{id:"lmat-dialog",style:"display:none;"}).text(e("Are you sure you want to change the language of the current content?","linguator-multilingual-ai-translation"));t.after(a);var n=new Promise(function(n,o){var i=function(e){switch(e){case"yes":t.data("old-value",t.children(":selected").first().val()),n();break;case"no":t.val(t.data("old-value")),o("Cancel")}a.dialog("close")},l={autoOpen:!1,modal:!0,draggable:!1,resizable:!1,title:e("Change language","linguator-multilingual-ai-translation"),minWidth:600,maxWidth:"100%",open:function(t,e){jQuery("body").hasClass("rtl")&&jQuery(this).parent().css({right:jQuery(this).parent().css("left"),left:"auto"})},close:function(t,e){i("no")},buttons:[{text:e("OK","linguator-multilingual-ai-translation"),click:function(t){i("yes")}},{text:e("Cancel","linguator-multilingual-ai-translation"),click:function(t){i("no")}}]};Object.assign(l,{classes:{"ui-dialog":"lmat-confirmation-modal"}}),a.dialog(l)});return{dialogContainer:a,dialogResult:n}}(),f=h.dialogContainer,m=h.dialogResult,_=n.target;location.pathname.match(/post-new.php/gi)&&g&&(r=_.value,-1!=location.search.indexOf("new_lang")?window.location.search=window.location.search.replace(/(?:new_lang=[^&]*)(&)?(.*)/,"new_lang="+r+"$1$2"):window.location.search=window.location.search+(-1!=window.location.search.indexOf("?")?"&":"?")+"new_lang="+r),a(this).data("old-value")===_.value||g?(e(),m=Promise.resolve()):f.dialog("open"),m.then(function(){var t={action:"lmat_post_lang_choice",lang:_.value,post_type:a("#post_type").val(),post_id:a("#post_ID").val(),_lmat_nonce:a("#_lmat_nonce").val()};a.post(ajaxurl,t,function(){var t,e,a;t=null,e=c("core/editor").getCurrentPost(),a=new Promise(function(a,n){t=d(function(){var t=c("core/editor").getCurrentPost(),o=t.id,i=t.status,l=t.type;c("core").getLastEntitySaveError("postType",l,o)&&n(),e.modified!==t.modified&&(location.pathname.match(/post-new.php/gi)&&"auto-draft"!==i&&o&&window.history.replaceState({id:o},"Post "+o,p("post.php",{post:o,action:"edit"})),a())})}),s("core/editor").savePost(),a.then(function(){window.location.reload()},function(){t()}).catch(function(){t()})})},function(){})}),jQuery(".tr_lang").each(function(){var t=jQuery(this).attr("id").substring(8),e=jQuery(this).parent().parent().siblings(".lmat-edit-column");jQuery(this).autocomplete({minLength:0,source:ajaxurl+"?action=lmat_posts_not_translated&post_language="+jQuery(".post_lang_choice").val()+"&translation_language="+t+"&post_type="+jQuery("#post_type").val()+"&_lmat_nonce="+jQuery("#_lmat_nonce").val(),select:function(a,n){jQuery("#htr_lang_"+t).val(n.item.id),e.html(n.item.link)}}),jQuery(this).on("blur",function(){jQuery(this).val()||(jQuery("#htr_lang_"+t).val(0),e.html(e.siblings(".hidden").children().clone()))})})})})();