(()=>{"use strict";var t={338:(t,e,a)=>{var n=a(795);e.createRoot=n.createRoot,e.hydrateRoot=n.hydrateRoot},795:t=>{t.exports=window.ReactDOM}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var l=e[n]={exports:{}};return t[n](l,l.exports,a),l.exports}a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};a.r(n),a.d(n,{allowedMetaFields:()=>X,contentSaveSource:()=>Q,contentSaveTranslate:()=>U,excerptSaveSource:()=>q,excerptSaveTranslate:()=>V,metaFieldsSaveSource:()=>Z,metaFieldsSaveTranslate:()=>K,setBlockRules:()=>J,titleSaveSource:()=>W,titleSaveTranslate:()=>z,translationInfo:()=>Y});var r={};a.r(r),a.d(r,{getAllowedMetaFields:()=>rt,getBlockRules:()=>et,getTranslatedString:()=>at,getTranslationEntry:()=>tt,getTranslationInfo:()=>nt});var l=a(338);const o=window.wp.element,s=window.wp.data,i=window.wp.i18n,c=t=>React.createElement("div",{className:"modal-header",key:t.modalRender},React.createElement("span",{className:"close",onClick:()=>{t.setPopupVisibility(!1)}},"×"),React.createElement("h2",{className:"notranslate"},(0,i.__)("Step 2 - Start Automatic Translation Process","autopoly-ai-translation-for-polylang")),React.createElement("div",{className:"save_btn_cont"},React.createElement("button",{className:"notranslate save_it button button-primary",disabled:t.translatePendingStatus,onClick:t.updatePostData},(0,i.__)("Update Content","autopoly-ai-translation-for-polylang")))),d=window.React,p=t=>{const e=t.skipTags||[],a=t=>{const n=document.createElement("div");n.innerHTML=t;const r=n.firstElementChild;if(!r)return t;let l=r.childNodes,o=l.length;if(o>0){l=Array.from(l).sort((t,e)=>3===t.nodeType?-1:3===e.nodeType?1:0);for(let t=0;t<o;t++){let e=l[t];if(3===e.nodeType){let t=e.textContent.replace(/^\s+|^\.\s+|^\s.|\s+$|\.\s+$|\s.\+$/g,t=>`#lmat_page_translation_open_translate_span#${t}#lmat_page_translation_close_translate_span#`);e.textContent=t}else if(8===e.nodeType){let t=`\x3c!--${e.textContent}--\x3e`;e.textContent=t}else{let t=a(e.outerHTML);e.outerHTML=t}}}let s=r.outerHTML.match(/^<[^>]+>/)[0];s=s.replace(/#lmat_page_translation_open_translate_span#|#lmat_page_translation_close_translate_span#/g,"");const i=r.tagName.toLowerCase(),c=new RegExp(`</${i}>`,"i"),d=r.outerHTML.match(c);if("<style>"===s)return`#lmat_page_translation_open_translate_span#${r.outerHTML}#lmat_page_translation_close_translate_span#`;let p=r.innerHTML;p=p.replace(/^\s+|^\.\s+|^\s.|\s+$|\.\s+$|\s.\+$/g,t=>`#lmat_page_translation_open_translate_span#${t}#lmat_page_translation_close_translate_span#`),r.innerHTML="";let m="",u="",g="";return u=`#lmat_page_translation_open_translate_span#${s}#lmat_page_translation_close_translate_span#`,d&&(m=`#lmat_page_translation_open_translate_span#</${i}>#lmat_page_translation_close_translate_span#`),e.includes(i)&&(p=p.replace(/#lmat_page_translation_open_translate_span#|#lmat_page_translation_close_translate_span#/g,""),p="#lmat_page_translation_open_translate_span#"+p+"#lmat_page_translation_close_translate_span#"),""!==p?(""!==u&&(g=u+p),""!==m&&(g+=m)):g=u+m,r.outerHTML=g,n.innerHTML},n=["yandex","localAiTranslator","google"].includes(t.service)?(e=>{/^(_yoast_wpseo_|rank_math_|_seopress_)/.test(t.contentKey.trim())&&(e=(t=>t.replace(/(%{1,2}[a-zA-Z0-9_]+%{0,2})/g,t=>`#lmat_page_translation_open_translate_span#${t}#lmat_page_translation_close_translate_span#`))(e));const n=/\[(.*?)\]/g;e.match(n)&&(e=e.replace(n,t=>`#lmat_page_translation_open_translate_span#${t}#lmat_page_translation_close_translate_span#`));const r=document.createElement("div");r.innerHTML=function(t){if("string"!=typeof t||!t.trim())return t;const e=/<\/?([a-zA-Z0-9]+)(\s[^>]*)?>/g,a=[];let n,r="",l=0;for(;null!==(n=e.exec(t));){const[o,s]=n,i=o.startsWith("</"),c=n.index;if(c>l&&(r+=t.slice(l,c)),i){const t=a.findIndex(t=>t.tag===s);-1!==t?(a.splice(t,1),r+=o):r+=`#lmat_page_translation_temp_tag_open#<${s}>#lmat_page_translation_temp_tag_close#`+o}else a.push({tag:s}),r+=o;l=e.lastIndex}l<t.length&&(r+=t.slice(l));for(let t=a.length-1;t>=0;t--){const{tag:e}=a[t];r+=`#lmat_page_translation_temp_tag_open#</${e}>#lmat_page_translation_temp_tag_close#`}return n=null,a.length=0,t=null,r}(e),function(t){let e=t.childNodes;const n=t=>{if(e.length>t){let r=e[t],l=null;if(3===r.nodeType){const t=r.textContent.replace(/^\s+|^\.\s+|^\s.|\s+$|\.\s+$|\s.\+$/g,t=>`#lmat_page_translation_open_translate_span#${t}#lmat_page_translation_close_translate_span#`);l=document.createTextNode(t)}else if(8===r.nodeType)l=document.createTextNode(`\x3c!--${r.textContent}--\x3e`);else{let t=a(r.outerHTML);l=document.createTextNode(t)}r.replaceWith(l),t++,n(t)}};n(0)}(r);let l=r.innerText;return l=l.replace(/#lmat_page_translation_temp_tag_open#([\s\S]*?)#lmat_page_translation_temp_tag_close#/g,""),(t=>t.split(/(#lmat_page_translation_open_translate_span#.*?#lmat_page_translation_close_translate_span#)|'/).filter(Boolean).filter(t=>""!==t.trim()))(l)})(t.content):t.content,r=/#lmat_page_translation_open_translate_span#[\s\S]*?#lmat_page_translation_close_translate_span#/,l=/#lmat_page_translation_open_translate_span#|#lmat_page_translation_close_translate_span#/g;return React.createElement(React.Fragment,null,["yandex","localAiTranslator","google"].includes(t.service)?n.map((t,e)=>r.test(t)?React.createElement("span",{key:e,className:"notranslate lmat-page-translation-notraslate-tag",translate:"no"},(t=>t.replace(l,""))(t)):t):n)},m=({number:t})=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t,u=(t,e="none",a=!1)=>{!1===a&&(a=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo().sourceCharacterCount);const n=document.querySelector(`.${t}-translator-strings-count`);n&&(n.style.display=e,n.querySelector(".totalChars").textContent=m({number:a}))},g=({container:t,provider:e,startTime:a,endTime:n,translateStatus:r,modalRenderId:l})=>{if(!document.querySelector(`#lmat-page-translation-${e}-strings-modal.modal-container[data-render-id="${l}"]`))return;t.querySelector(".lmat_page_translation_translate_progress").style.display="none",t.querySelector(".lmat_page_translation_string_container").style.animation="none",document.body.style.top="0";const o=t.querySelector("button.save_it");o.removeAttribute("disabled"),o.classList.add("translated"),o.classList.remove("notranslate"),(({provider:t,startTime:e,endTime:a})=>{const n=document.getElementById("lmat_page_translation_strings_model").querySelector(".lmat_page_translation_string_container").querySelectorAll('td.translate[data-string-type]:not([data-translate-status="translated"])'),r=n.length,l=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields();n.forEach((n,o)=>{const i=n.innerText,c=n.dataset.key,d=n.dataset.stringType,p=n.closest("tr").querySelector('td[data-source="source_text"]').innerText;(({type:t,key:e,translateContent:a,source:n,provider:r,AllowedMetaFields:l})=>{if(["title","excerpt"].includes(t)){const e=`${t}SaveTranslate`;(0,s.dispatch)("block-lmatMachineTranslate/translate")[e](a,r)}else["metaFields"].includes(t)?Object.keys(l).includes(e)&&(0,s.dispatch)("block-lmatMachineTranslate/translate").metaFieldsSaveTranslate(e,a,n,r):(0,s.dispatch)("block-lmatMachineTranslate/translate").contentSaveTranslate(e,a,n,r)})({type:d,key:c,translateContent:i,source:p,provider:t,AllowedMetaFields:l});const m=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo().translateData[t],g=m&&m.targetStringCount?m.targetStringCount:0,_=m&&m.targetWordCount?m.targetWordCount:0,y=m&&m.targetCharacterCount?m.targetCharacterCount:0;""!==i.trim()&&i.trim().length>0&&(0,s.dispatch)("block-lmatMachineTranslate/translate").translationInfo({targetStringCount:g+p.trim().split(/(?<=[.!?]+)\s+/).length,targetWordCount:_+p.trim().split(/\s+/).filter(t=>/[^\p{L}\p{N}]/.test(t)).length,targetCharacterCount:y+p.trim().length,provider:t}),o===r-1&&(jQuery(`.${t}-translator_progress`).css("width","100%"),u(t,"block"),(({prefix:t=!1,start:e=!1,end:a=!1,translateStatus:n=!1})=>{const r=(a-e)/1e3,l={};if(t){if(l.provider=t,e&&a){const e=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo().translateData[t]?.timeTaken||0;l.timeTaken=r+e}n&&(l.translateStatus=!0),(0,s.dispatch)("block-lmatMachineTranslate/translate").translationInfo(l)}})({prefix:t,start:e,end:a,translateStatus:!0}))})})({provider:e,startTime:a,endTime:n}),r(!1)},_=(t,e,a)=>{const n=(new Date).getTime();let r=!1;(t=>{if(document.querySelector(`#lmat-page-translation-${t}-progress-bar`))jQuery(`.${t}-translator_progress`).css("width","0%"),jQuery(`.${t}-translator-strings-count`).hide();else{const e=jQuery(`\n            <div id="lmat-page-translation-${t}-progress-bar" class="lmat-page-translation-translate-progress-bar">\n                <div class="${t}-translator_progress_bar" style="background-color: #f3f3f3;border-radius: 10px;overflow: hidden;margin: 1.5rem auto; width: 50%;">\n                <div class="${t}-translator_progress" style="overflow: hidden;transition: width .2s ease-in-out; border-radius: 10px;text-align: center;width: 0%;height: 20px;box-sizing: border-box;background-color: #4caf50; color: #fff; font-weight: 600;"></div>\n                </div>\n                <div style="display:none; color: white;" class="${t}-translator-strings-count hidden">\n                    Wahooo! You have saved your valuable time via auto translating \n                    <strong class="totalChars"></strong> characters using \n                    <strong>\n                        ${t} Translator\n                    </strong>\n                </div>\n            </div>\n        `);jQuery("#lmat_page_translation_strings_model .lmat_page_translation_translate_progress").append(e)}})(e);const l=document.getElementById("lmat_page_translation_strings_model"),o=l.querySelector(".lmat_page_translation_string_container");o.scrollTop=0;const s=o.scrollHeight;if(void 0!==s&&s>100){if(document.querySelector(".lmat_page_translation_translate_progress").style.display="block",setTimeout(()=>{const t=2e3*Math.ceil(s/o?.offsetHeight);(t=>{const{element:e,scrollSpeed:a,provider:n}=t;if(e.scrollHeight-e.offsetHeight<=0)return;const r=jQuery(`.${n}-translator_progress_bar`);let l=null,o=e.scrollTop;const s=()=>{const t=e.scrollHeight-e.offsetHeight+100,i=performance.now();l||(l=i);const c=o+(i-l)/a*(t+2e3-o);var d=e.scrollTop/(e.scrollHeight-e.clientHeight)*100;r.find(`.${n}-translator_progress`).css("width",d+"%");let p=(Math.round(10*d)/10).toFixed(1);p=Math.min(p,100).toString(),r.find(`.${n}-translator_progress`).text(p+"%"),c>t?u(n,"block"):(e.scrollTop=c,c<t&&setTimeout(s,16))};s()})({element:o,scrollSpeed:t,provider:e})},2e3),o.addEventListener("scroll",()=>{if(o.scrollTop+o.clientHeight+50>=o.scrollHeight&&!r){const o=(new Date).getTime();setTimeout(()=>{g({container:l,provider:e,startTime:n,endTime:o,translateStatus:t,modalRenderId:a})},4e3),r=!0}}),o.clientHeight+10>=s){jQuery(`.${e}-translator_progress`).css("width","100%"),jQuery(`.${e}-translator_progress`).text("100%"),u(e,"block");const r=(new Date).getTime();setTimeout(()=>{g({container:l,provider:e,startTime:n,endTime:r,translateStatus:t,modalRenderId:a})},4e3)}}else{jQuery(`.${e}-translator_progress`).css("width","100%"),jQuery(`.${e}-translator_progress`).text("100%"),u(e,"block");const r=(new Date).getTime();setTimeout(()=>{g({container:l,provider:e,startTime:n,endTime:r,translateStatus:t,modalRenderId:a})},4e3)}},y=t=>{const{sourceLang:e,targetLang:a,ID:n,translateStatusHandler:r,modalRenderId:l}=t;let o=a,s=e;"zh"===o&&(o=lmatPageTranslationGlobal.languageObject.zh?.locale.replace("_","-")),"zh"===s&&(s=lmatPageTranslationGlobal.languageObject.zh?.locale.replace("_","-")),new google.translate.TranslateElement({pageLanguage:s,includedLanguages:o,defaultLanguage:s,multilanguagePage:!0,autoDisplay:!1},n);const i=document.querySelector(`#${n}`);i&&i.children.length<=0&&Object.values(google?.translate?.TranslateElement()).map(t=>{t instanceof HTMLElement&&"lmat_google_translate_element"===t.id&&i.replaceWith(t)}),document.querySelector(`#${n}`).addEventListener("change",()=>{_(r,"google",l)})},h=t=>{t=t||{};const{Service:e=!1,openErrorModalHandler:a=()=>{}}=t,n=(window.lmatPageTranslationGlobal.admin_url,window.lmatPageTranslationGlobal.lmat_url+"Admin/Assets/images/error-icon.svg"),r={google:{Provider:y,title:"Google Translate",SettingBtnText:"Translate",serviceLabel:"Google Translate",Docs:"https://docs.coolplugins.net/doc/google-translate-for-polylang/?utm_source=lmat_plugin&utm_medium=inside&utm_campaign=docs&utm_content=popup_google",heading:(0,i.__)("Choose Language","linguator-multilingual-ai-translation"),BetaEnabled:!1,ButtonDisabled:t.googleButtonDisabled,ErrorMessage:t.googleButtonDisabled?React.createElement("div",{className:"lmat-provider-error button button-primary",onClick:()=>a("google")},React.createElement("img",{src:n,alt:"error"})," ",(0,i.__)("View Error","linguator-multilingual-ai-translation")):React.createElement(React.Fragment,null),Logo:"google.png"},localAiTranslator:{title:"Chrome Built-in AI",SettingBtnText:"Translate",serviceLabel:"Chrome AI Translator",heading:(0,i.sprintf)((0,i.__)("Translate Using %s","autopoly-ai-translation-for-polylang"),"Chrome built-in API"),Docs:"https://docs.coolplugins.net/doc/chrome-ai-translation-polylang/?utm_source=lmat_page_translation_plugin&utm_medium=inside&utm_campaign=docs&utm_content=popup_chrome",BetaEnabled:!0,ButtonDisabled:!0,ErrorMessage:React.createElement("div",{className:"lmat-page-translation-provider-disabled button button-primary"},(0,i.__)("Upcoming Feature","autopoly-ai-translation-for-polylang")),Logo:"chrome.png"}};return e?r[e]:r},b=t=>{const{service:e}=t,a=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationEntry(),n=t.stringModalBodyNotice;return(0,d.useEffect)(()=>{["yandex","google"].includes(t.service)&&(document.documentElement.setAttribute("translate","no"),document.body.classList.add("notranslate"));const e=t.service,a=`lmat_page_translation_${e}_translate_element`;wp.data.select("block-lmatMachineTranslate/translate").getTranslationEntry().length>0&&t.postDataFetchStatus&&h({Service:e}).Provider({sourceLang:t.sourceLang,targetLang:t.targetLang,translateStatusHandler:t.translateStatusHandler,ID:a,translateStatus:t.translateStatus,modalRenderId:t.modalRender,destroyUpdateHandler:t.updateDestroyHandler})},[t.modalRender,t.postDataFetchStatus]),React.createElement("div",{className:"modal-body"},a.length>0&&t.postDataFetchStatus?React.createElement(React.Fragment,null,n&&React.createElement("div",{className:"lmat-page-translation-body-notice-wrapper"},React.createElement(n,null)),React.createElement("div",{className:"lmat_page_translation_translate_progress",key:t.modalRender},(0,i.__)("Automatic translation is in progress....","autopoly-ai-translation-for-polylang"),React.createElement("br",null),(0,i.__)("It will take few minutes, enjoy ☕ coffee in this time!","autopoly-ai-translation-for-polylang"),React.createElement("br",null),React.createElement("br",null),(0,i.__)("Please do not leave this window or browser tab while translation is in progress...","autopoly-ai-translation-for-polylang")),React.createElement("div",{className:`translator-widget ${e}`,style:{display:"flex"}},React.createElement("h3",{className:"choose-lang"},h({Service:t.service}).heading," ",React.createElement("span",{className:"dashicons-before dashicons-translation"})),React.createElement("div",{className:"lmat_page_translation_translate_element_wrapper "+(t.translateStatus?"translate-completed":"")},React.createElement("div",{id:`lmat_page_translation_${t.service}_translate_element`}))),React.createElement("div",{className:"lmat_page_translation_string_container"},React.createElement("table",{className:"scrolldown",id:"stringTemplate"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"notranslate"},(0,i.__)("S.No","autopoly-ai-translation-for-polylang")),React.createElement("th",{className:"notranslate"},(0,i.__)("Source Text","autopoly-ai-translation-for-polylang")),React.createElement("th",{className:"notranslate"},(0,i.__)("Translation","autopoly-ai-translation-for-polylang")))),React.createElement("tbody",null,t.postDataFetchStatus&&React.createElement(React.Fragment,null,a.map((e,a)=>React.createElement(o.Fragment,{key:a+t.translatePendingStatus},void 0!==e.source&&""!==e.source.trim()&&React.createElement(React.Fragment,null,React.createElement("tr",{key:a+"tr"+t.translatePendingStatus},React.createElement("td",null,a+1),React.createElement("td",{"data-source":"source_text"},e.source),t.translatePendingStatus?React.createElement("td",{className:"translate",translate:"yes","data-key":e.id,"data-string-type":e.type},React.createElement(p,{service:t.service,content:e.source,contentKey:e.id})):React.createElement("td",{className:"translate","data-translate-status":"translated","data-key":e.id,"data-string-type":e.type},e.translatedData[t.service])))))))))):t.postDataFetchStatus?React.createElement("p",null,(0,i.__)("No strings are available for translation","autopoly-ai-translation-for-polylang")):React.createElement("div",{className:"lmat-page-translation-skeleton-loader-wrapper"},React.createElement("div",{className:"translate-widget"},React.createElement("div",{className:"lmat-page-translation-skeleton-loader-mini"}),React.createElement("div",{className:"lmat-page-translation-skeleton-loader-mini"})),React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"notranslate"},(0,i.__)("S.No","autopoly-ai-translation-for-polylang")),React.createElement("th",{className:"notranslate"},(0,i.__)("Source Text","autopoly-ai-translation-for-polylang")),React.createElement("th",{className:"notranslate"},(0,i.__)("Translation","autopoly-ai-translation-for-polylang")))),React.createElement("tbody",null,[...Array(10)].map((t,e)=>React.createElement("tr",{key:e},React.createElement("td",null,React.createElement("div",{className:"lmat-page-translation-skeleton-loader-mini"})),React.createElement("td",null,React.createElement("div",{className:"lmat-page-translation-skeleton-loader-mini"})),React.createElement("td",null,React.createElement("div",{className:"lmat-page-translation-skeleton-loader-mini"}))))))))},f=t=>React.createElement("div",{className:`notice inline notice-info is-dismissible ${t.className}`},Array.isArray(t.children)?t.children.join(" "):t.children),T=t=>React.createElement("div",{className:"modal-footer",key:t.modalRender},!t.translatePendingStatus&&React.createElement(f,{className:"lmat_page_translation_string_count"},React.createElement("p",null,(0,i.__)("Wahooo! You have saved your valuable time via auto translating","autopoly-ai-translation-for-polylang")," ",React.createElement("strong",null,React.createElement(m,{number:t.characterCount}))," ",(0,i.__)("characters using","autopoly-ai-translation-for-polylang")," ",React.createElement("strong",null,t.serviceLabel),".",(0,i.__)("Please share your feedback —","autopoly-ai-translation-for-polylang"),React.createElement("a",{href:"https://wordpress.org/support/plugin/automatic-translations-for-polylang/reviews/#new-post",target:"_blank",rel:"noopener",style:{color:"yellow"}},(0,i.__)("leave a quick review","autopoly-ai-translation-for-polylang")),"!")),React.createElement("div",{className:"save_btn_cont"},React.createElement("button",{className:"notranslate save_it button button-primary",disabled:t.translatePendingStatus,onClick:t.updatePostData},(0,i.__)("Update Content","autopoly-ai-translation-for-polylang"))));function v(){return v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},v.apply(null,arguments)}const w=t=>{let e=t.service;const a=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo().translateData[e]||!1,n=a?.translateStatus||!1,[r,l]=(0,o.useState)(!0),[i,d]=(0,o.useState)(""),[p,m]=(0,o.useState)(!0),[u,g]=(0,o.useState)(a?.targetCharacterCount||0),[_,y]=(0,o.useState)([]),h=t=>{y(e=>[...e,t])};(0,o.useEffect)(()=>{r||_.length>0&&_.forEach(t=>{"function"==typeof t&&t()})},[r,_]);const f=()=>{const e=t.service;return"localAiTranslator"===e?"Chrome AI Translator":e.replace(/^\w/,t=>t.toUpperCase())+" Translate"};(0,o.useEffect)(()=>{t.postDataFetchStatus||t.fetchPostData({postId:t.postId,sourceLang:t.sourceLang,targetLang:t.targetLang,updatePostDataFetch:t.updatePostDataFetch,refPostData:t=>d(t),updateDestroyHandler:h})},[t.postDataFetchStatus,t.modalRender]);const w=e=>{"yandex"===t.service&&document.querySelector("#lmat_page_translation_yandex_translate_element #yt-widget .yt-button__icon.yt-button__icon_type_right")?.click(),m(!0),l(!1)},k=()=>{const e=i;let a=t.service;t.translatePost({postContent:e,modalClose:()=>l(!1),service:a}),t.pageTranslate(!0),(({provider:t,sourceLang:e,targetLang:a,postId:n})=>{const r=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo(),l=r.translateData?.[t]?.targetStringCount||0,o=r.translateData?.[t]?.targetWordCount||0,i=r.translateData?.[t]?.targetCharacterCount||0,c=r.translateData?.[t]?.timeTaken||0,d=r?.sourceWordCount||0,p=r?.sourceCharacterCount||0,m=r?.sourceStringCount||0,u={provider:t,totalStringCount:l,totalWordCount:o,totalCharacterCount:i,editorType:lmatPageTranslationGlobal.editor_type,date:(new Date).toISOString(),sourceStringCount:m,sourceWordCount:d,sourceCharacterCount:p,sourceLang:e,targetLang:a,timeTaken:c,action:lmatPageTranslationGlobal.update_translate_data,update_translation_key:lmatPageTranslationGlobal.update_translation_check,post_id:n};fetch(lmatPageTranslationGlobal.ajax_url,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(u)}).then(t=>t.json()).then(t=>{console.log(t.data.message)}).catch(t=>{console.error(t)})})({provider:a,sourceLang:t.sourceLang,targetLang:t.targetLang,postId:t.currentPostId})};return(0,o.useEffect)(()=>{l(!0),n&&(g(a?.targetCharacterCount||0),m(!1)),setTimeout(()=>{const t=document.querySelector(".lmat_page_translation_string_container");t&&(t.scrollTop=0)})},[t.modalRender]),React.createElement(React.Fragment,null," ",r&&React.createElement("div",{id:`lmat-page-translation-${t.service}-strings-modal`,className:"modal-container",style:{display:r?"flex":"none"},"data-render-id":t.modalRender},React.createElement("div",{className:"modal-content"},React.createElement(c,{modalRender:t.modalRender,setPopupVisibility:w,postContent:i,translatePendingStatus:p,pageTranslate:t.pageTranslate,service:t.service,serviceLabel:f(),updatePostData:k,characterCount:u}),React.createElement(b,v({},t,{updatePostContent:t=>{d(t)},contentLoading:t.contentLoading,postDataFetchStatus:t.postDataFetchStatus,translatePendingStatus:p,service:t.service,sourceLang:t.sourceLang,targetLang:t.targetLang,translateStatusHandler:e=>{let a=t.service;const n=(0,s.select)("block-lmatMachineTranslate/translate").getTranslationInfo().translateData[a]?.targetCharacterCount||0;g(n),m(e)},modalRender:t.modalRender,translateStatus:n,stringModalBodyNotice:t.stringModalBodyNotice,updateDestroyHandler:h})),React.createElement(T,{modalRender:t.modalRender,setPopupVisibility:w,postContent:i,translatePendingStatus:p,pageTranslate:t.pageTranslate,service:t.service,serviceLabel:f(),updatePostData:k,characterCount:u}))))},k=({setSettingVisibility:t})=>React.createElement("div",{className:"modal-header"},React.createElement("h2",null,(0,i.__)("Step 1 - Select Translation Provider","automatic-translations-for-polylang-pro")),React.createElement("span",{className:"close",onClick:()=>t(!1)},"×")),E=t=>{const e=t.Service,a=t[e+"Disabled"],n=h({Service:e,[e+"ButtonDisabled"]:a,openErrorModalHandler:t.openErrorModalHandler}),r=`lmat-page-translation-${e.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/[^a-z0-9-]/g,"")}-btn`;return React.createElement("tr",null,React.createElement("td",{className:"lmat-page-translation-provider-name"},React.createElement("img",{src:`${t.imgFolder}${n.Logo}`,alt:n.title}),React.createElement("span",null,n.title)),React.createElement("td",null,n.ButtonDisabled?n.ErrorMessage:React.createElement("div",{id:r,onClick:t.fetchContent,className:"lmat-page-translation-service-btn button button-primary","data-service":e,"data-service-label":n.ServiceLabel},n.SettingBtnText)),React.createElement("td",null,React.createElement("a",{href:n.Docs,target:"_blank",rel:"noopener noreferrer",className:"lmat-page-translation-doc-icon"},React.createElement("svg",{width:"9",height:"12",viewBox:"0 0 9 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M2.17607 6.20533H6.82393V5.53867H2.17607V6.20533ZM2.17607 8.05133H6.82393V7.38467H2.17607V8.05133ZM2.17607 9.898H4.89536V9.23133H2.17607V9.898ZM1.03821 12C0.7425 12 0.495643 11.8973 0.297643 11.692C0.0996427 11.4867 0.000428571 11.2304 0 10.9233V1.07667C0 0.77 0.0992142 0.514 0.297643 0.308667C0.496071 0.103333 0.743143 0.000444444 1.03886 0H6.10714L9 3V10.9233C9 11.23 8.901 11.4862 8.703 11.692C8.505 11.8978 8.25771 12.0004 7.96114 12H1.03821ZM5.78571 3.33333V0.666667H1.03886C0.939857 0.666667 0.849 0.709333 0.766286 0.794666C0.683571 0.88 0.642429 0.974 0.642857 1.07667V10.9233C0.642857 11.0256 0.684 11.1196 0.766286 11.2053C0.848571 11.2911 0.939214 11.3338 1.03821 11.3333H7.96179C8.06036 11.3333 8.151 11.2907 8.23371 11.2053C8.31643 11.12 8.35757 11.0258 8.35714 10.9227V3.33333H5.78571Z",fill:"#6F6F6F"})))))};function S(){return S=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},S.apply(null,arguments)}const R=t=>{const e=h();return React.createElement("div",{className:"lmat-page-translation-setting-modal-body"},React.createElement("div",{className:"lmat-page-translation-setting-modal-notice-wrapper"}),React.createElement("table",null,React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Name"),React.createElement("th",null,"Translate"),React.createElement("th",null,"Docs"))),React.createElement("tbody",null,Object.keys(e).map(e=>React.createElement(E,S({key:e},t,{Service:e}))))))},C=t=>{const{targetLangName:e,postType:a,sourceLangName:n,setSettingVisibility:r}=t;return React.createElement("div",{className:"modal-footer"},React.createElement("p",{className:"lmat-page-translation-error-message",style:{marginBottom:".5rem"}},sprintf((0,i.__)("This will replace your current %(postType)s with a %(target)s translation of the original %(source)s content.","automatic-translations-for-polylang-pro"),{postType:a,source:n,target:e})),React.createElement("button",{className:"lmat-page-translation-setting-close button button-primary",onClick:()=>r(!1)},(0,i.__)("Close","automatic-translations-for-polylang-pro")))},x=({message:t,onClose:e,Title:a})=>{let n=jQuery("<div>").append(t);const r=n.html();return n.remove(),n=null,(0,o.useEffect)(()=>{const t=document.querySelectorAll(".chrome-ai-translator-flags");if(t.length>0)return t.forEach(t=>{t.classList.add("lmat-page-translation-tooltip-element"),t.addEventListener("click",e=>{if(e.preventDefault(),t.querySelector(".lmat-page-translation-tooltip"))return;let a=document.createElement("span");a.textContent="Text to be copied.",a.className="lmat-page-translation-tooltip",t.appendChild(a),(async({text:t=!1,startCopyStatus:e=()=>{},endCopyStatus:a=()=>{}})=>{if(t&&""!==t)try{if(navigator?.clipboard?.writeText)await navigator.clipboard.writeText(t);else{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(e)}e(),setTimeout(()=>a(),800)}catch(t){console.error("Error copying text to clipboard:",t)}})({text:t.getAttribute("data-clipboard-text"),startCopyStatus:()=>{a.classList.add("lmat-page-translation-tooltip-active")},endCopyStatus:()=>{setTimeout(()=>{a.remove()},800)}})})}),()=>{t.forEach(t=>{t.removeEventListener("click",()=>{})})}},[]),React.createElement("div",{className:"lmat-page-translation-error-modal-box-container"},React.createElement("div",{className:"lmat-page-translation-error-modal-box"},React.createElement("div",{className:"lmat-page-translation-error-modal-box-header"},React.createElement("span",{className:"lmat-page-translation-error-modal-box-close",onClick:e},"×"),a&&React.createElement("h3",null,a)),React.createElement("div",{className:"lmat-page-translation-error-modal-box-body"},React.createElement("p",{dangerouslySetInnerHTML:{__html:r}})),React.createElement("div",{className:"lmat-page-translation-error-modal-box-footer"},React.createElement("button",{className:"lmat-page-translation-error-modal-box-close button button-primary",onClick:e},"Close"))))};function L(){return L=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)({}).hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},L.apply(null,arguments)}const P=t=>{const[e,a]=(0,o.useState)({}),[n,r]=(0,o.useState)(0),[s,c]=(0,o.useState)(!1),d=lmatPageTranslationGlobal.source_lang,p=t.targetLang,m=lmatPageTranslationGlobal.languageObject[d].name,u=lmatPageTranslationGlobal.languageObject[p].name,g=lmatPageTranslationGlobal.lmat_url+"Admin/Assets/images/",_=["ab","ace","ach","aa","af","sq","alz","am","ar","hy","as","av","awa","ay","az","ban","bal","bm","bci","ba","eu","btx","bts","bbc","be","bem","bn","bew","bho","bik","bs","br","bg","bua","yue","ca","ceb","ch","ce","ny","zh-CN","zh-TW","chk","cv","co","crh","crh-Latn","hr","cs","da","fa-AF","dv","din","doi","dov","nl","dyu","dz","en","eo","et","ee","fo","fj","tl","fi","fon","fr","fr-CA","fy","fur","ff","gaa","gl","ka","de","el","gn","gu","ht","cnh","ha","haw","iw","hil","hi","hmn","hu","hrx","iba","is","ig","ilo","id","iu-Latn","iu","ga","it","jam","ja","jw","kac","kl","kn","kr","pam","kk","kha","km","cgg","kg","rw","ktu","trp","kv","gom","ko","kri","ku","ckb","ky","lo","ltg","la","lv","lij","li","ln","lt","lmo","lg","luo","lb","mk","mad","mai","mak","mg","ms","ms-Arab","ml","mt","mam","gv","mi","mr","mh","mwr","mfe","chm","mni-Mtei","min","lus","mn","my","nhe","ndc-ZW","nr","new","ne","bm-Nkoo","no","nus","oc","or","om","os","pag","pap","ps","fa","pl","pt","pt-PT","pa","pa-Arab","qu","kek","rom","ro","rn","ru","se","sm","sg","sa","sat-Latn","sat","gd","nso","sr","st","crs","shn","sn","scn","szl","sd","si","sk","sl","so","es","su","sus","sw","ss","sv","ty","tg","ber-Latn","ber","ta","tt","te","tet","th","bo","ti","tiv","tpi","to","lua","ts","tn","tcy","tum","tr","tk","tyv","ak","udm","uk","ur","ug","uz","ve","vec","vi","war","cy","wo","xh","sah","yi","yo","yua","zap","zu"].includes("zh"===p?lmatPageTranslationGlobal.languageObject.zh?.locale.replace("_","-"):p),[y,h]=(0,o.useState)({}),[b,f]=(0,o.useState)(!1),[T,v]=(0,o.useState)(!1),E=t=>{t.preventDefault();const e=t.target;"yes"===e.dataset.value&&c(!0),e.closest("#lmat-page-translation-modal-open-warning-wrapper").remove()};(0,o.useEffect)(()=>{const e=document.querySelectorAll("#lmat-page-translation-modal-open-warning-wrapper .modal-content div[data-value]"),a=document.querySelector(t.translateWrpSelector);a&&a.addEventListener("click",t=>{t.preventDefault(),c(t=>!t)}),e.forEach(t=>{t&&t.addEventListener("click",E)})},[]),(0,o.useEffect)(()=>{s&&(_||h(t=>({...t,google:{message:"<p style={{ fontSize: '1rem', color: '#ff4646' }}>"+(0,i.sprintf)((0,i.__)("Google Translate does not support the target language: %s.","linguator-multilingual-ai-translation"),"<strong>"+u+"</strong>")+"</p>",Title:(0,i.__)("Google Translate","linguator-multilingual-ai-translation")}})))},[s]),(0,o.useEffect)(()=>{const a=e,r=a.dataset&&a.dataset.service,o=a.dataset&&a.dataset.serviceLabel,s=t.postId,i=document.getElementById("lmat_page_translation_strings_model");i&&(i._reactRoot||(i._reactRoot=l.createRoot(i)),n&&i._reactRoot.render(React.createElement(w,{currentPostId:t.currentPostId,postId:s,service:r,serviceLabel:o,sourceLang:d,targetLang:p,modalRender:n,pageTranslate:t.pageTranslate,postDataFetchStatus:t.postDataFetchStatus,fetchPostData:t.fetchPostData,translatePost:t.translatePost,contentLoading:t.contentLoading,updatePostDataFetch:t.updatePostDataFetch,stringModalBodyNotice:t.stringModalBodyNotice})))},[t.postDataFetchStatus,n]);const S=t=>{c(t)};return React.createElement(React.Fragment,null,b&&y[b]&&React.createElement(x,L({onClose:()=>{f(!1)}},y[b])),s&&React.createElement("div",{className:"modal-container",style:{display:s?"flex":"none"}},React.createElement("div",{className:"lmat-page-translation-settings modal-content"},React.createElement(k,{setSettingVisibility:S,postType:t.postType,sourceLangName:m,targetLangName:u}),React.createElement(R,{googleDisabled:!_,fetchContent:async t=>{let e=t.target.classList.contains("lmat-page-translation-service-btn")?t.target:t.target.closest(".lmat-page-translation-service-btn");e&&(c(!1),r(t=>t+1),a(e))},imgFolder:g,targetLangName:u,postType:t.postType,sourceLangName:m,openErrorModalHandler:t=>{c(!1),f(t)}}),React.createElement(C,{targetLangName:u,postType:t.postType,sourceLangName:m,setSettingVisibility:S}))))},D="SAVE_SOURCE_TITLE",N="SAVE_TRANSLATE_TITLE",F="SAVE_SOURCE_EXCERPT",M="SAVE_TRANSLATE_EXCERPT",j="SAVE_SOURCE_CONTENT",A="SAVE_TRANSLATE_CONTENT",O="SAVE_SOURCE_META_FIELDS",I="SAVE_TRANSLATE_META_FIELDS",$="SET_BLOCK_RULES",B="SAVE_TRANSLATE_INFO",H="ALLOWED_META_FIELDS",G={title:{},excerpt:{},content:[],metaFields:{},allowedMetaFields:{}},W=t=>({type:D,text:t}),z=(t,e)=>({type:N,text:t,provider:e}),q=t=>({type:F,text:t}),V=(t,e)=>({type:M,text:t,provider:e}),Q=(t,e)=>({type:j,text:e,id:t}),U=(t,e,a,n)=>({type:A,text:e,id:t,source:a,provider:n}),Z=(t,e)=>({type:O,text:e,id:t}),K=(t,e,a,n)=>({type:I,text:e,id:t,source:a,provider:n}),J=t=>({type:$,data:t}),Y=({sourceStringCount:t=null,sourceWordCount:e=null,sourceCharacterCount:a=null,timeTaken:n=null,provider:r=null,targetStringCount:l=null,targetWordCount:o=null,targetCharacterCount:s=null,translateStatus:i=null})=>({type:B,sourceStringCount:t,sourceWordCount:e,sourceCharacterCount:a,timeTaken:n,targetStringCount:l,targetWordCount:o,targetCharacterCount:s,provider:r,translateStatus:i}),X=({id:t,type:e})=>({type:H,id:t,inputType:e}),tt=t=>{const e=new Array;return t.title.source&&e.push({id:"title",source:t.title.source,type:"title",translatedData:t.title.translatedData||{}}),t.excerpt.source&&e.push({id:"excerpt",source:t.excerpt.source,type:"excerpt",translatedData:t.excerpt.translatedData||{}}),Object.keys(t.metaFields).map(a=>{e.push({type:"metaFields",id:a,source:t.metaFields[a].source,translatedData:t.metaFields[a].translatedData||{}})}),Object.keys(t.content).map(a=>{e.push({type:"content",id:a,source:t.content[a].source,translatedData:t.content[a].translatedData||{}})}),e},et=t=>t.blockRules,at=(t,e,a,n=null,r=null)=>["title","excerpt"].includes(e)&&t[e].source===a&&t[e].translatedData&&t[e].translatedData[r]?t[e]?.translatedData[r]||t[e]?.source:"metaFields"===e&&t.metaFields&&t.metaFields[n]&&t.metaFields[n].source===a&&t.metaFields[n].translatedData&&t.metaFields[n].translatedData[r]?void 0!==t.metaFields[n]?.translatedData[r]?t.metaFields[n]?.translatedData[r]:t.metaFields[n]?.source:"content"===e&&t.content&&t.content[n]&&t.content[n].source===a&&t.content[n].translatedData&&t.content[n].translatedData[r]?void 0!==t.content[n]?.translatedData[r]?t.content[n]?.translatedData[r]:t.content[n]?.source:a,nt=t=>({sourceStringCount:t?.translationInfo?.sourceStringCount||0,sourceWordCount:t?.translationInfo?.sourceWordCount||0,sourceCharacterCount:t?.translationInfo?.sourceCharacterCount||0,translateData:t?.translationInfo?.translateData||{}}),rt=t=>t.allowedMetaFields||{},{createReduxStore:lt,register:ot}=wp.data;ot(lt("block-lmatMachineTranslate/translate",{reducer:(t=G,e)=>{switch(e.type){case D:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,title:{...t.title,source:e.text}}:t;case N:return{...t,title:{...t.title,translatedData:{...t.title.translatedData||[],[e.provider]:e.text}}};case F:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,excerpt:{...t.excerpt,source:e.text}}:t;case M:return{...t,excerpt:{...t.excerpt,translatedData:{...t.excerpt.translatedData||[],[e.provider]:e.text}}};case j:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,content:{...t.content,[e.id]:{...t.content[e.id]||[],source:e.text}}}:t;case A:return t.content[e.id].source===e.source?{...t,content:{...t.content,[e.id]:{...t.content[e.id]||[],translatedData:{...t.content[e.id].translatedData||[],[e.provider]:e.text}}}}:t;case O:return/[\p{L}\p{N}]/gu.test(e.text)?{...t,metaFields:{...t.metaFields,[e.id]:{...t.metaFields[e.id]||[],source:e.text}}}:t;case I:return{...t,metaFields:{...t.metaFields,[e.id]:{...t.metaFields[e.id]||[],translatedData:{...t.metaFields[e.id].translatedData||[],[e.provider]:e.text}}}};case $:return{...t,blockRules:e.data};case B:const a={};return e.sourceStringCount&&(a.sourceStringCount=e.sourceStringCount),e.sourceWordCount&&(a.sourceWordCount=e.sourceWordCount),e.sourceCharacterCount&&(a.sourceCharacterCount=e.sourceCharacterCount),(e.targetWordCount||e.targetCharacterCount||e.translateStatus||e.timeTaken)&&e.provider&&(a.translateData={...t.translationInfo?.translateData||{},[e.provider]:{...t.translationInfo?.translateData?.[e.provider]||{},...e.targetStringCount&&{targetStringCount:e.targetStringCount},...e.targetWordCount&&{targetWordCount:e.targetWordCount},...e.targetCharacterCount&&{targetCharacterCount:e.targetCharacterCount},...e.translateStatus&&{translateStatus:e.translateStatus},...e.timeTaken&&{timeTaken:e.timeTaken}}}),{...t,translationInfo:{...t.translationInfo,...a}};case H:return{...t,allowedMetaFields:{...t.allowedMetaFields,[e.id]:{...t.allowedMetaFields[e.id]||[],inputType:e.inputType}}};default:return t}},actions:n,selectors:r}));const st=(t,e,a,n)=>{const r=(t,e)=>{Object.keys(e).map(a=>{let r=e;r=r[a];const l=new Array(...t,a);n(l,r)})};Object.getPrototypeOf(e)===Array.prototype?((t,e)=>{const l=new Array(...t);let o=a;l.forEach(t=>{o=o[t]}),[null,void 0].includes(o)||(Object.getPrototypeOf(o)!==Object.prototype?(Object.getPrototypeOf(o)===Array.prototype&&o.forEach((t,a)=>{const r=new Array;l.forEach(t=>{r.push(t)}),r.push(a),n(r,e[0])}),"object"!=typeof o||r(t,e[0])):r(t,e[0]))})(t,e):Object.getPrototypeOf(e)===Object.prototype&&r(t,e)},it=(t,e)=>{Object.keys(e.LmatBlockParseRules).includes(t.name)&&((t,e,a)=>{const n=Object.values(a),r=(a,n)=>{if(!0===n){const n=new Array(...a),r=new Array;let l=e,o=t;n.forEach(t=>{r.push(t),o+=`lmatMachineTranslate${t}`,l=l[t]});let i=l;if(i instanceof wp.richText.RichTextData&&(i=i.originalHTML),void 0!==i&&""!==i.trim()){let t=o.replace(/[^\p{L}\p{N}]/gu,"");if(!/[\p{L}\p{N}]/gu.test(i))return!1;(0,s.dispatch)("block-lmatMachineTranslate/translate").contentSaveSource(t,i)}return}st(a,n,e,r)};n.forEach(t=>{Object.keys(t).forEach(e=>{const a=new Array(e);r(a,t[e])})})})(t.clientId,t.attributes,e.LmatBlockParseRules[t.name])},ct=(t,e)=>{t.forEach(t=>{it(t,e),t.innerBlocks&&ct(t.innerBlocks,e)})},dt=window.wp.blocks,pt={_yoast_wpseo_title:{type:"string"},_yoast_wpseo_focuskw:{type:"string"},_yoast_wpseo_metadesc:{type:"string"},_yoast_wpseo_bctitle:{type:"string"},"_yoast_wpseo_opengraph-title":{type:"string"},"_yoast_wpseo_opengraph-description":{type:"string"},"_yoast_wpseo_twitter-title":{type:"string"},"_yoast_wpseo_twitter-description":{type:"string"},rank_math_title:{type:"string"},rank_math_description:{type:"string"},rank_math_focus_keyword:{type:"string"},rank_math_facebook_title:{type:"string"},rank_math_facebook_description:{type:"string"},rank_math_twitter_title:{type:"string"},rank_math_twitter_description:{type:"string"},rank_math_breadcrumb_title:{type:"string"},_seopress_titles_title:{type:"string"},_seopress_titles_desc:{type:"string"},_seopress_social_fb_title:{type:"string"},_seopress_social_fb_desc:{type:"string"},_seopress_social_twitter_title:{type:"string"},_seopress_social_twitter_desc:{type:"string"},_seopress_analysis_target_kw:{type:"string"}},mt=async t=>{const e=lmatPageTranslationGlobal.ajax_url;let a={};const n=t=>{(0,s.dispatch)("block-lmatMachineTranslate/translate").allowedMetaFields(t)};Object.keys(pt).forEach(t=>{n({id:t,type:pt[t].type})}),(()=>{const t="true"===lmatPageTranslationGlobal.postMetaSync;if(window.acf&&!t){const t=["text","textarea","wysiwyg"];acf.getFields().forEach(e=>{e.data&&t.includes(e.data.type)&&n({id:e.data.key,type:e.data.type})})}})();const r={lmat_fetch_block_rules_key:lmatPageTranslationGlobal.fetchBlockRulesNonce,action:lmatPageTranslationGlobal.action_block_rules};await fetch(e,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(r)}).then(t=>t.json()).then(t=>{a=JSON.parse(t.data.blockRules),(0,s.dispatch)("block-lmatMachineTranslate/translate").setBlockRules(a)}).catch(t=>{console.error("Error fetching post content:",t)});const l={postId:parseInt(t.postId),local:t.targetLang,current_local:t.sourceLang,lmat_page_translation_nonce:lmatPageTranslationGlobal.ajax_nonce,action:lmatPageTranslationGlobal.action_fetch};await fetch(e,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams(l)}).then(t=>t.json()).then(e=>{const n=e.data;n.content&&""!==n.content.trim()&&(n.content=(0,dt.parse)(n.content)),((t,e)=>{const a=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields();Object.keys(t).forEach(n=>{if("content"===n)((t,e)=>{Object.values(t).forEach(t=>{it(t,e),t.innerBlocks&&ct(t.innerBlocks,e)})})(t[n],e);else if("metaFields"===n)Object.keys(t[n]).forEach(e=>{Object.keys(a).includes(e)&&"string"===a[e].inputType&&""!==t[n][e][0]&&void 0!==t[n][e][0]&&(0,s.dispatch)("block-lmatMachineTranslate/translate").metaFieldsSaveSource(e,t[n][e][0])}),window.acf&&acf.getFields().forEach(e=>{if(e.data&&a[e.data.key]){const a=e.data.name,r=acf.getField(e.data.key)?.val();t[n]&&t[n][a]?""!==t[n][a]&&void 0!==t[n][a]&&(0,s.dispatch)("block-lmatMachineTranslate/translate").metaFieldsSaveSource(e.data.key,t[n][a][0]):r&&""!==r&&void 0!==r&&(0,s.dispatch)("block-lmatMachineTranslate/translate").metaFieldsSaveSource(e.data.key,r)}});else if(["title","excerpt"].includes(n)&&t[n]&&""!==t[n].trim()){const e=`${n}SaveSource`;(0,s.dispatch)("block-lmatMachineTranslate/translate")[e](t[n])}})})(n,a),t.refPostData(n),t.updatePostDataFetch(!0)}).catch(t=>{console.error("Error fetching post content:",t)})},ut=(t,e,a,n)=>{const{createBlock:r}=wp.blocks,{name:l,attributes:o}=t;let s={...o},i=t,c="";return Object.keys(a.LmatBlockParseRules).includes(t.name)&&(i=((t,e,a)=>{const{select:n}=wp.data,r=Object.values(e),l=t.attributes,o=t.clientId,s=(e,r)=>{if(!0===r){const r=new Array(...e),s=new Array;let i=l,c=o;r.forEach(t=>{s.push(t),c+=`lmatMachineTranslate${t}`,i=i[t]});let d=i;if(d instanceof wp.richText.RichTextData&&(d=d.originalHTML),void 0!==d&&""!==d.trim()){let e=c.replace(/[^\p{L}\p{N}]/gu,""),l="";l=/[\p{L}\p{N}]/gu.test(d)?n("block-lmatMachineTranslate/translate").getTranslatedString("content",d,e,a):d,t.attributes=((t,e,a)=>{const n={...t};let r=n;for(let t=0;t<e.length-1;t++)Object.getPrototypeOf(r[e[t]])===Array.prototype?r[e[t]]=[...r[e[t]]]:r[e[t]]={...r[e[t]]},r=r[e[t]];return r[e[e.length-1]]instanceof wp.richText.RichTextData?r[e[e.length-1]]=a.replace(/(?<!\\)"|\\"/g,"'"):r[e[e.length-1]]=a,n})(t.attributes,r,l)}return}st(e,r,l,s)};return r.forEach(t=>{Object.keys(t).forEach(e=>{const a=new Array(e);s(a,t[e])})}),t})(t,a.LmatBlockParseRules[t.name],n),s=i.attributes),c=r(l,s,e),c},gt=(t,e,a)=>{let n=t.innerBlocks.map(t=>{if(t.name)return gt(t,e,a)});return ut(t,n,e,a)},_t=t=>{if(!(0,s.dispatch)("yoast-seo/editor"))return;const{updateData:e,setFocusKeyword:a,setBreadcrumbsTitle:n,setFacebookPreviewTitle:r,setFacebookPreviewDescription:l,setTwitterPreviewTitle:o,setTwitterPreviewDescription:i}=(0,s.dispatch)("yoast-seo/editor"),{key:c,value:d}=t;switch(c){case"_yoast_wpseo_focuskw":a&&a(d);break;case"_yoast_wpseo_title":e&&e({title:d});break;case"_yoast_wpseo_metadesc":e&&e({description:d});break;case"_yoast_wpseo_bctitle":n&&n(d);break;case"_yoast_wpseo_opengraph-title":r&&r(d);break;case"_yoast_wpseo_opengraph-description":l&&l(d);break;case"_yoast_wpseo_twitter-title":o&&o(d);break;case"_yoast_wpseo_twitter-description":i&&i(d)}},yt=t=>{if(!(0,s.dispatch)("rank-math"))return;const{updateKeywords:e,updateTitle:a,updateDescription:n,updateBreadcrumbTitle:r,updateFacebookTitle:l,updateFacebookDescription:o,updateTwitterTitle:i,updateTwitterDescription:c}=(0,s.dispatch)("rank-math"),{key:d,value:p}=t;switch(d){case"rank_math_focus_keyword":e&&e(p);break;case"rank_math_title":a&&a(p);break;case"rank_math_description":n&&n(p);break;case"rank_math_breadcrumb_title":r&&r(p);break;case"rank_math_facebook_title":l&&l(p);break;case"rank_math_facebook_description":o&&o(p);break;case"rank_math_twitter_title":i&&i(p);break;case"rank_math_twitter_description":c&&c(p)}},ht=t=>{const{editPost:e}=(0,s.dispatch)("core/editor"),{modalClose:a,postContent:n,service:r}=t;(()=>{const t={};Object.keys(n).filter(t=>["title","excerpt"].includes(t)).forEach(e=>{const a=n[e];if(""!==a.trim()){const n=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString(e,a,null,r);t[e]=n}}),e(t)})(),(()=>{const t=n.metaFields,a=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields();Object.keys(t).forEach(n=>{if(Object.keys(a).includes(n)){const l=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString("metaFields",t[n][0],n,r);n.startsWith("_yoast_wpseo_")&&"string"===a[n].inputType?_t({key:n,value:l}):n.startsWith("rank_math_")&&"string"===a[n].inputType?yt({key:n,value:l}):n.startsWith("_seopress_")&&"string"===a[n].inputType?(async t=>{const{key:e,value:a}=t,n=e.replace(/^_/,"")+"_meta";if(document.querySelector("#"+n))switch(e){case"_seopress_titles_title":case"_seopress_titles_desc":case"_seopress_social_fb_title":case"_seopress_social_fb_desc":case"_seopress_social_twitter_title":case"_seopress_social_twitter_desc":jQuery(`#${n}`).val(a),jQuery(`#${n}`).trigger("change");break;case"_seopress_analysis_target_kw":window.target_kw&&window.target_kw instanceof window.Tagify&&window.target_kw.DOM.originalInput.id===n?window.target_kw.addTags(a):(jQuery("#"+n).val(a),jQuery("#"+n).trigger("change"))}})({key:n,value:l}):e({meta:{[n]:l}})}})})(),(()=>{const t=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields(),e=n.metaFields;window.acf&&acf.getFields().forEach(a=>{if(a.data&&a.data.key&&Object.keys(t).includes(a.data.key)){const t=acf.getField(a.data.key),n=a.data.key,l=a.data.name,o=t.data.type,i=e[l]?e[l][0]:acf.getField(n)?.val(),c=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString("metaFields",i,n,r);if("wysiwyg"===o&&tinymce){const e=t.data.id;tinymce.get(e)?.setContent(c)}else acf.getField(n)?.val(c)}})})(),(()=>{const t=n.content;t.length<=0||Object.values(t).forEach(t=>{((t,e)=>{const{select:a}=wp.data,n=a("block-lmatMachineTranslate/translate").getBlockRules(),{dispatch:r}=wp.data,{name:l}=t;if(l){let a=t.innerBlocks.map(t=>{if(t.name)return gt(t,n,e)});const l=ut(t,a,n,e);r("core/block-editor").insertBlock(l)}})(t,r)})})(),a()},bt=t=>{const e=()=>{const t=document.querySelector(".lmat-page-translation-body-notice-wrapper");if(t){const e=t.offsetHeight+t.offsetTop;t.closest(".modal-body").style.setProperty("--lmat-page-translation-notice-wrapper-height",`${e}px`)}};return(0,d.useEffect)(()=>(t.lastNotice&&(e(),window.addEventListener("resize",e)),()=>{window.removeEventListener("resize",e)}),[t.lastNotice]),React.createElement("div",{className:t.className},t.children)},ft=async t=>{const e=lmatPageTranslationGlobal.elementorData&&"string"==typeof lmatPageTranslationGlobal.elementorData?JSON.parse(lmatPageTranslationGlobal.elementorData):lmatPageTranslationGlobal.elementorData,a=lmatPageTranslationGlobal?.metaFields,n={widgetsContent:e,metaFields:a};Object.keys(pt).forEach(t=>{var e;e={id:t,type:pt[t].type},(0,s.dispatch)("block-lmatMachineTranslate/translate").allowedMetaFields(e)}),(t=>{const e=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields(),a=(t,e,n)=>{t(e[n],n),++n<e.length&&a(t,e,n)},n=(t,e)=>{if("string"==typeof e&&""!==e.trim()&&t.length>0){const a=t.join("_lmat_page_translation_");e&&""!==e&&(0,s.dispatch)("block-lmatMachineTranslate/translate").contentSaveSource(a,e)}},r=["content_width","title_size","font_size","margin","padding","background","border","color","text_align","font_weight","font_family","line_height","letter_spacing","text_transform","border_radius","box_shadow","opacity","width","height","display","position","z_index","visibility","align","max_width","content_typography_typography","flex_justify_content","title_color","description_color","email_content"],l=["title","description","editor","text","content","label"],o=(t,e,s=[])=>{const i=t.settings;if(s.push(e),"object"==typeof i&&null!==i&&Object.keys(i).length>0){const t=(t,e)=>{if(!r.some(e=>t.toLowerCase().includes(e))&&(l.some(e=>t.toLowerCase().includes(e))&&"string"==typeof i[t]&&""!==i[t].trim()&&n([...s,"settings",t],i[t]),Array.isArray(i[t])&&i[t].length>0)){const e=(e,o)=>{"object"==typeof e&&null!==e&&a(a=>{r.includes(a.toLowerCase())||l.some(t=>a.toLowerCase().includes(t))&&"string"==typeof e[a]&&""!==e[a].trim()&&n([...s,"settings",t,o,a],e[a])},Object.keys(e),0)};a(e,i[t],0)}};a(t,Object.keys(i),0)}if(t.elements&&Array.isArray(t.elements)&&t.elements.length>0){const e=(t,e)=>{o(t,e,[...s,"elements"])};a(e,t.elements,0)}};var i;t.widgetsContent&&t.widgetsContent.length>0&&a((t,e)=>{o(t,e,[])},t.widgetsContent,0),i=t.metaFields,Object.keys(i).forEach(t=>{Object.keys(e).includes(t)&&"string"===e[t].inputType&&""!==i[t][0]&&void 0!==i[t][0]&&(0,s.dispatch)("block-lmatMachineTranslate/translate").metaFieldsSaveSource(t,i[t][0])})})(n),t.refPostData(n),t.updatePostDataFetch(!0)},Tt=(t,e)=>{for(const a of t){if(a.get("id")===e)return a;const t=a.get("elements").models,n=Tt(t,e);if(n)return n}return null},vt=({postContent:t,modalClose:e,service:a})=>{const n=elementor.config.document.id,r=[],l=["content_width","title_size","font_size","margin","padding","background","border","color","text_align","font_weight","font_family","line_height","letter_spacing","text_transform","border_radius","box_shadow","opacity","width","height","display","position","z_index","visibility","align","max_width","content_typography_typography","flex_justify_content","title_color","description_color","email_content"],o=(t,e,n=[])=>{const i=t.id,c=t.settings;if(n.push(e),"object"==typeof c&&null!==c){const t=["title","description","editor","text","content","label"];Object.keys(c).forEach(e=>{if(!l.some(t=>e.toLowerCase().includes(t))){if(t.some(t=>e.toLowerCase().includes(t))&&"string"==typeof c[e]&&""!==c[e].trim()){const t=n.join("_lmat_page_translation_")+"_lmat_page_translation_settings_lmat_page_translation_"+e,l=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString("content",c[e],t,a);r.push({ID:i,key:e,translatedContent:l})}Array.isArray(c[e])&&c[e].forEach((o,c)=>{"object"==typeof o&&null!==o&&Object.keys(o).forEach(d=>{if(!l.includes(d.toLowerCase())&&t.some(t=>d.toLowerCase().includes(t))&&"string"==typeof o[d]&&""!==o[d].trim()){const t=`${e}[${c}].${d}`,l=n.join("_lmat_page_translation_")+"_lmat_page_translation_settings_lmat_page_translation_"+e+"_lmat_page_translation_"+c+"_lmat_page_translation_"+d,p=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString("content",o[d],l,a);r.push({ID:i,key:t,translatedContent:p})}})})}})}t.elements&&Array.isArray(t.elements)&&t.elements.forEach((t,e)=>{o(t,e,[...n,"elements"])})};t.widgetsContent.map((t,e)=>o(t,e,[])),(t=>{t.forEach(t=>{const e=Tt(elementor.elements.models,t.ID);if(e){const a=e.get("settings");a.get(t.key)&&a.set(t.key,t.translatedContent);const n=t.key.match(/(.+)\[(\d+)\]\.(.+)/);if(n){const[e,r,l,o]=n,s=a.get(r);Array.isArray(s.models)&&s.models[l]&&(s.models[l].attributes[o]=t.translatedContent,a.set(r,s))}}}),$e.internal("document/save/set-is-modified",{status:!0})})(r),((t,e)=>{const a=(0,s.select)("block-lmatMachineTranslate/translate").getAllowedMetaFields();Object.keys(t).forEach(n=>{if(Object.keys(a).includes(n)){const r=(0,s.select)("block-lmatMachineTranslate/translate").getTranslatedString("metaFields",t[n][0],n,e);n.startsWith("_yoast_wpseo_")&&"string"===a[n].inputType?_t({key:n,value:r}):n.startsWith("rank_math_")&&"string"===a[n].inputType?yt({key:n,value:r}):n.startsWith("_seopress_")&&"string"===a[n].inputType&&elementor?.settings?.page?.model?.setExternalChange(n,r)}})})(t.metaFields,a);const i=(()=>{const t=lmatPageTranslationGlobal.elementorData;return wp.data.select("block-lmatMachineTranslate/translate").getTranslationEntry().forEach(e=>{const n=e.source,r=e.id,l=e.translatedData,o=e.type;if(!n||""===n&&"content"!==o)return;const s=r.split("_lmat_page_translation_"),i=l[a];let c=null,d=null,p=t;s.forEach(t=>{c=p,d=t,p=p[t]}),c&&d&&c[d]&&c[d]===n&&(c[d]=i)}),t})();fetch(lmatPageTranslationGlobal.ajax_url,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json"},body:new URLSearchParams({action:lmatPageTranslationGlobal.update_elementor_data,post_id:n,elementor_data:JSON.stringify(i),lmat_page_translation_nonce:lmatPageTranslationGlobal.ajax_nonce})}).then(t=>t.json()).then(t=>{if(t.success){const t=document.querySelector('.lmat-page-translation-button[name="lmat_page_translation_meta_box_translate"]');t&&t.setAttribute("title","Translation process completed successfully."),elementor.reloadPreview()}else console.error("Failed to update Elementor data:",t.data);elementor.reloadPreview(),e()}).catch(t=>{elementor.reloadPreview(),e(),console.error("Error updating Elementor data:",t)})},wt=window.lmatPageTranslationGlobal.editor_type,kt=()=>{let t=new Array;t.push('\x3c!-- The Modal --\x3e<div id="lmat-page-translation-setting-modal"></div>','<div id="lmat_page_translation_strings_model" class="modal lmat_page_translation_custom_model"></div>'),t.forEach(t=>{document.body.insertAdjacentHTML("beforeend",t)})},Et=()=>{const t=[];if("gutenberg"===wt){"true"===lmatPageTranslationGlobal.postMetaSync&&t.push({className:"lmat-page-translation-notice lmat-page-translation-notice-warning",message:React.createElement("p",null,(0,i.__)("For accurate custom field translations, please disable the Custom Fields synchronization in ","autopoly-ai-translation-for-polylang"),React.createElement("a",{href:`${lmatPageTranslationGlobal.admin_url}admin.php?page=mlang_settings`,target:"_blank",rel:"noopener noreferrer"},(0,i.__)("Polylang settings","autopoly-ai-translation-for-polylang")),(0,i.__)(". This may affect linked posts or pages.","autopoly-ai-translation-for-polylang"))});const e=(0,s.select)("block-lmatMachineTranslate/translate").getBlockRules();e.LmatBlockParseRules&&0!==Object.keys(e.LmatBlockParseRules).length||t.push({className:"lmat-page-translation-notice lmat-page-translation-notice-error",message:React.createElement("p",null,(0,i.__)("No block rules were found. It appears that the block-rules.JSON file could not be fetched, possibly because it is blocked by your server settings. Please check your server configuration to resolve this issue.","autopoly-ai-translation-for-polylang"))})}const e=t.length;if(t.length>0)return t.map((t,a)=>React.createElement(bt,{className:t.className,key:a,lastNotice:a===e-1},t.message))},St=()=>{const[t,e]=(0,d.useState)(!1),a=window.lmatPageTranslationGlobal.target_lang,n=window.lmatPageTranslationGlobal.parent_post_id,r=window.lmatPageTranslationGlobal.current_post_id,l=window.lmatPageTranslationGlobal.post_type;let o,s,c;const p=window.lmatPageTranslationGlobal.source_lang;"elementor"===wt?(c='button.lmat-page-translation-button[name="lmat_page_translation_meta_box_translate"]',o=vt,s=ft):"gutenberg"===wt&&(c='input#lmat-page-translation-button[name="lmat_page_translation_meta_box_translate"]',o=ht,s=mt);const[m,u]=(0,d.useState)(!1),[g,_]=(0,d.useState)(!0);if((0,d.useEffect)(()=>{if(t){const t=document.querySelector(c);t&&(t.disabled=!0,t.value=(0,i.__)("Already Translated","autopoly-ai-translation-for-polylang"))}},[t]),!p||""===p){const t=document.querySelector(c);return void(t&&(t.title=`Parent ${window.lmatPageTranslationGlobal.post_type} may be deleted.`,t.disabled=!0))}return React.createElement(React.Fragment,null,!t&&p&&""!==p&&React.createElement(P,{contentLoading:g,updatePostDataFetch:t=>{u(t),_(!1)},postDataFetchStatus:m,pageTranslate:t=>{e(t)},postId:n,currentPostId:r,targetLang:a,postType:l,fetchPostData:async t=>{await s(t);const e=wp.data.select("block-lmatMachineTranslate/translate").getTranslationEntry();let a=0,n=0,r=0;e.map(t=>{const e=t.source?t.source:"",l=e.split(/(?<=[.!?]+)\s+/).length,o=e.trim().split(/\s+/).filter(t=>/[^\p{L}\p{N}]/.test(t)).length,s=e.length;a+=l,n+=s,r+=o}),wp.data.dispatch("block-lmatMachineTranslate/translate").translationInfo({sourceStringCount:a,sourceWordCount:r,sourceCharacterCount:n})},translatePost:o,translateWrpSelector:c,stringModalBodyNotice:Et}))},Rt=()=>{const t=jQuery(".MuiButtonGroup-root.MuiButtonGroup-contained").parent(),e=jQuery(t).find(".elementor-button.lmat-page-translation-button");if(t.length>0&&0===e.length){const e=jQuery('<button class="elementor-button lmat-page-translation-button" name="lmat_page_translation_meta_box_translate">Translate</button>');if(t.prepend(e),$e.internal("document/save/set-is-modified",{status:!0}),""===window.lmatPageTranslationGlobal.elementorData||window.lmatPageTranslationGlobal.elementorData.length<1||elementor.elements.length<1)return e.attr("disabled","disabled"),void e.attr("title","Translation is not available because there is no Elementor data.");kt(),l.createRoot(document.getElementById("lmat-page-translation-setting-modal")).render(React.createElement(St,null))}};"gutenberg"===wt&&window.addEventListener("load",()=>{kt();const t=window.lmatPageTranslationGlobal.source_lang;t&&""!==t&&(()=>{const t=document.getElementById("lmat-page-translation-setting-modal"),e=(()=>{const t=window.lmatPageTranslationGlobal.post_type,e=window.lmatPageTranslationGlobal.target_lang,a=lmatPageTranslationGlobal.languageObject[e].name,n=document.createElement("div");return n.id="lmat-page-translation-modal-open-warning-wrapper",n.innerHTML=`\n    <div class="modal-container" style="display: flex">\n      <div class="modal-content">\n        <p>${(0,i.sprintf)((0,i.__)("Would you like to duplicate your original %s content and have it automatically translated into %s?","autopoly-ai-translation-for-polylang"),t,a)}</p>\n        <div>\n          <div data-value="yes">${(0,i.__)("Yes","autopoly-ai-translation-for-polylang")}</div>\n          <div data-value="no">${(0,i.__)("No","autopoly-ai-translation-for-polylang")}</div>\n        </div>\n      </div>\n    </div>`,n})();document.body.insertBefore(e,t)})(),l.createRoot(document.getElementById("lmat-page-translation-setting-modal")).render(React.createElement(St,null))}),"elementor"===wt&&jQuery(window).on("elementor:init",function(){elementor.on("document:loaded",Rt)})})();