(()=>{"use strict";var t=jQuery(".post_lang_choice"),a=function(){t.attr("data-old-value",t.children(":selected").first().val())};function e(){var t=document.querySelector("[name=post_lang_choice]");return null===t?lmatDefaultLanguage:t.value}function n(t){return void 0===t.data||null===t.data?t.path+=(t.path.indexOf("?")>=0?"&lang=":"?lang=")+e():t.data.lang=e(),t}wp.apiFetch.use(function(t,a){return void 0!==t.url||"undefined"==typeof lmatFilteredRoutes?a(t):a(function(t,a,e){var n=t.path.split("?")[0].replace(/^\/+|\/+$/g,"");return Object.values(a).find(function(t){return n===t})?e(t):t}(t,lmatFilteredRoutes,n))}),jQuery(function(e){a(),e(".post_lang_choice").on("change",function(n){var o,i,l,r,u=wp.data,c=u.select,s=u.dispatch,d=u.subscribe,g=!(null!==(o=(l=c("core/editor")).getEditedPostAttribute("title"))&&void 0!==o&&o.trim()||l.getEditedPostContent()||null!==(i=l.getEditedPostAttribute("excerpt"))&&void 0!==i&&i.trim()),p=wp.url.addQueryArgs,h=function(){var a=wp.i18n.__,e=jQuery("<div/>",{id:"lmat-dialog",style:"display:none;"}).text(a("Are you sure you want to change the language of the current content?","linguator-multilingual-ai-translation"));t.after(e);var n=new Promise(function(n,o){var i=function(a){switch(a){case"yes":t.data("old-value",t.children(":selected").first().val()),n();break;case"no":t.val(t.data("old-value")),o("Cancel")}e.dialog("close")},l={autoOpen:!1,modal:!0,draggable:!1,resizable:!1,title:a("Change language","linguator-multilingual-ai-translation"),minWidth:600,maxWidth:"100%",open:function(t,a){jQuery("body").hasClass("rtl")&&jQuery(this).parent().css({right:jQuery(this).parent().css("left"),left:"auto"})},close:function(t,a){i("no")},buttons:[{text:a("OK","linguator-multilingual-ai-translation"),click:function(t){i("yes")}},{text:a("Cancel","linguator-multilingual-ai-translation"),click:function(t){i("no")}}]};Object.assign(l,{classes:{"ui-dialog":"lmat-confirmation-modal"}}),e.dialog(l)});return{dialogContainer:e,dialogResult:n}}(),f=h.dialogContainer,m=h.dialogResult,v=n.target;location.pathname.match(/post-new.php/gi)&&g&&(r=v.value,-1!=location.search.indexOf("lang")?window.location.search=window.location.search.replace(/(?:lang=[^&]*)(&)?(.*)/,"lang="+r+"$1$2"):window.location.search=window.location.search+(-1!=window.location.search.indexOf("?")?"&":"?")+"lang="+r),e(this).data("old-value")===v.value||g?(a(),m=Promise.resolve()):f.dialog("open"),m.then(function(){var t={action:"lmat_post_lang_choice",lang:v.value,post_type:e("#post_type").val(),post_id:e("#post_ID").val(),_lmat_nonce:e("#_lmat_nonce").val()};e.post(ajaxurl,t,function(){var t,a,e;t=null,a=c("core/editor").getCurrentPost(),e=new Promise(function(e,n){t=d(function(){var t=c("core/editor").getCurrentPost(),o=t.id,i=t.status,l=t.type;c("core").getLastEntitySaveError("postType",l,o)&&n(),a.modified!==t.modified&&(location.pathname.match(/post-new.php/gi)&&"auto-draft"!==i&&o&&window.history.replaceState({id:o},"Post "+o,p("post.php",{post:o,action:"edit"})),e())})}),s("core/editor").savePost(),e.then(function(){window.location.reload()},function(){t()}).catch(function(){t()})})},function(){})}),jQuery(".tr_lang").each(function(){var t=jQuery(this).attr("id").substring(8),a=jQuery(this).parent().parent().siblings(".lmat-edit-column");jQuery(this).autocomplete({minLength:0,source:ajaxurl+"?action=lmat_posts_not_translated&post_language="+jQuery(".post_lang_choice").val()+"&translation_language="+t+"&post_type="+jQuery("#post_type").val()+"&_lmat_nonce="+jQuery("#_lmat_nonce").val(),select:function(e,n){jQuery("#htr_lang_"+t).val(n.item.id),a.html(n.item.link)}}),jQuery(this).on("blur",function(){jQuery(this).val()||(jQuery("#htr_lang_"+t).val(0),a.html(a.siblings(".hidden").children().clone()))})})})})();